$(function(){if(!Gobal.IsWeixin){$(".m-block-header").show();$(".column-wrapper").addClass("m-site-column ")}var i=false;var d=null;var a=$("#divLoading");var b=$("#divLottery");var c=$(".weixin-mask");var e=10;var g=0;var f={SortID:0,FIdx:1,EIdx:e,isCount:1};var h=function(){var s=function(){var t=function(){return"SortID="+f.SortID+"&FIdx="+f.FIdx+"&EIdx="+f.EIdx+"&isCount="+f.isCount};var u=function(){GetJPData("","getLotteryList",t(),function(A){if(A.code==0){if(f.isCount==1){g=A.count;f.isCount=0}var z=A.listItems,F=null;var E=z.length;for(var B=0;B<E;B++){F=z[B];var C="https://img.1yyg.net/goodspic/pic-200-200/"+F.codeGoodsPic,D="https://img.1yyg.net/UserFace/",x="/"+Gobal.SiteVer+"/userpage/"+F.userWeb,v="/"+Gobal.SiteVer+"/lottery/detail-"+F.codeID+".do";D+=(F.userPhoto.length>0)?F.userPhoto:"00000000000000000.jpg";var w='<li id="'+F.codeID+'">    <div class="pro-img">        <a href="'+v+'"><img src="'+Gobal.LoadPic+'"  src2="'+C+'" /></a>    </div>    <div class="pro-info">        <div class="pro-getter">            <div class="pro-getter-img">                <img id="img'+F.codeID+'" src="'+D+'" /></div>            <div class="pro-getter-info">                <p class="pro-getter-name blue"><a href="'+x+'" class="blue">'+F.userName+'</a></p>                <p class="pro-getter-num gray6"><strong class="orange">'+F.codeRUserBuyCount+'</strong>人次获得</p>            </div>        </div>        <p class="gray9">幸运云购码：<em class="orange">'+F.codeRNO+'</em></p>        <p class="gray9">揭晓时间：<em>'+F.codeRTime+"</em></p>    </div></li>";var y=$(w);$(y).click(function(){location.href="/"+Gobal.SiteVer+"/lottery/detail-"+$(this).attr("id")+".do"});b.append(y)}if(f.EIdx<g){_IsLoading=false}else{_IsLoading=true;a.hide()}loadImgFun()}else{a.hide();if(f.FIdx==1){_IsLoading=true;b.html(Gobal.NoneHtml)}}})};this.getInitPage=function(){f.FIdx=1;f.EIdx=e;f.isCount=1;g=0;b.empty();u()};this.getFirstPage=function(){u()};this.getNextPage=function(){f.FIdx+=e;f.EIdx+=e;u()}};d=new s();d.getFirstPage();var k=$("#div_sort");var j=k.children("div.announced-sort");var n=k.children("span");c.bind("click",function(){$(this).hide();o=false;j.hide();n.find("cite").hide();_IsLoading=false;$("body").attr("style","");IsMasked=false});j.children("a").bind("click",function(t){stopBubble(t);if($(this).attr("type")=="-1"){return}$(this).addClass("orange").siblings().removeClass("orange");j.hide();n.children("cite").prev().html($(this).html());n.children("cite").hide();f.SortID=$(this).attr("type");if(parseInt(f.SortID)>0){if(q!=null){clearTimeout(q)}}else{m=0;l=",";p()}c.hide();_IsLoading=false;o=false;$("body").attr("style","");IsMasked=false;d.getInitPage()});var o=false;k.bind("click",function(t){stopBubble(t);if(o){o=false;j.hide();n.find("cite").hide();c.hide();_IsLoading=false;$("body").attr("style","");IsMasked=false}else{o=true;j.show();n.find("cite").show();c.height($(document).height()).show();_IsLoading=true;$("body").attr("style","overflow:hidden;");IsMasked=true}});var l=",";var r=false;var m=0;var q=null;var p=function(){GetJPData("https://api.1yyg.com","GetStartRaffleAllList","time="+m,function(u){if(u.errorCode==0){t(u,b)}q=setTimeout(p,i?5000*100:5000)});var t=function(v,w){m=v.maxSeconds;var u=function(B,D){for(var z=B.length-1;z>-1;z--){var A=B[z];if(l.indexOf(","+A.codeID+",")<0){l+=A.codeID+",";var x="https://img.1yyg.net/goodspic/pic-200-200/"+A.goodsPic;var y='<li id="'+A.codeID+'">	<div class="pro-img"><img src="'+x+'" /></div>	<div class="pro-info">		<h6 class="pro-title gray6">(第'+A.period+"云) "+A.goodsSName+'</h6>		<p class="gray9">价值：￥<em>'+CastMoney(A.price)+'</em></p>		<p class="gray9">揭晓倒计时：</p>			<div class="pro-state">			<div class="time-wrapper">				<em>00</em>				<span>:</span>				<em>00</em>				<span>:</span>				<em>					<i>0</i><i>0</i>				</em>			</div>		</div>	</div></li>';var C=$(y);C.click(function(){location.href="/"+Gobal.SiteVer+"/product/"+$(this).attr("id")+".do"});D.prepend(C);C.next().removeClass("rFirst");C.StartTimeOut(A.codeID,parseInt(A.seconds))}}};if(r){u(v.listItems,w)}else{Base.getScript(Gobal.Skin+"/DataServer/JS/LotteryTimeFun.js?v=170329",function(){r=true;u(v.listItems,w)})}}};p();scrollForLoadData(d.getNextPage)};Base.getScript(Gobal.Skin+"/JS/pageDialog.js?v=160304",h)});