var Wx=Wx||{};Wx.MobileCheck={passportUrl:"https://passport.1yyg.com",mobileVal:null,codeObj:null,codeErr:{Empty:"请输入6位验证码",LenErr:"验证码长度不对吧",Err:"验证码错误或过期"},isDigitLetter:function(b){var a=/^[0-9a-zA-Z]{6,}$/;return a.test(b)},FailDialog:function(a){$.PageDialog.fail(a)},OKDialog:function(b,a){$.PageDialog.ok(b,a)},isLoaded:true,btnSendMsg:null,btnSubmit:null,hidMobile:"",init:function(){var a=this;a.mobileVal=$("#hidMobile").val();a.codeObj=$("#txtCode");a.btnSendMsg=$("#btnSend");a.btnSubmit=$("#btnSubmit");a.eventReg();a.vcCodeEvtReg();a.btnSubmit.click(function(){if(a.btnSubmit.hasClass("grayBtn")){return false}else{a.submitSaveData()}});a.isLoaded=true},eventReg:function(){var a=this;a.codeObj.bind("keydown",function(c){var b=(window.event)?event.keyCode:c.keyCode;if(b==32){return false}else{if(b==13){return false}}return true})},vcCodeEvtReg:function(){var a=this;var b={before:function(){return a.beforeShowDialog.apply(a)},startEvt:function(){return true},key:function(){return a.mobileVal},isHttps:true,clickSuccess:function(){a.btnSubmit.attr("class","orgBtn");a.sendMsgInterval()},cancelDialogCallback:function(){a.btnSendMsg.attr("class","orgBtn")}};a.btnSendMsg.vcCode4Mobile(b)},beforeShowDialog:function(){var a=this;if(a.btnSendMsg.hasClass("orgBtn")){return true}return false},interval:null,timeSpan:120,sendMsgInterval:function(){var c=this;if(!c.btnSendMsg.hasClass("grayBtn")){c.btnSendMsg.attr("class","grayBtn").html("正在发送");var b=function(){var d=function(){c.timeSpan--;if(c.timeSpan>0){c.btnSendMsg.html("重新发送("+c.timeSpan+")")}else{c.resetFun()}};c.interval=setInterval(d,1000)};var a=function(){c.btnSendMsg.attr("class","orgBtn").html("重新发送")};c.sendMsg(b,a)}},resetFun:function(){var a=this;a.timeSpan=120;clearInterval(a.interval);a.interval=null;a.btnSendMsg.attr("class","orgBtn").html("重新发送");$.vcCode4Mobile.options.isVcCodeValidated=false;$.vcCode4Mobile.options.isDragEnabled=true},sendMsg:function(b,a){var c=this;GetJPData(c.passportUrl,"sendMsgVcCode","userMobile="+c.mobileVal+"&auth="+$.vcCode4Mobile.options.authstr,function(d){if(d.state==0){b();c.OKDialog("手机验证短信已发送！");c.btnSubmit.removeClass("grayBtn")}else{if(d.state==2){a();c.FailDialog("获取手机验证码太频繁！")}else{a();c.FailDialog("验证码发送失败["+d.code+"]！")}}c.isLoaded=true})},submitSaveData:function(){var b=this;if(!b.isLoaded){return}if(b.btnSubmit.hasClass("grayBtn")){return false}var a=b.codeObj.val();if(a==""){b.FailDialog(b.codeErr.Empty);return false}else{if(!b.isDigitLetter(a)){b.FailDialog(b.codeErr.LenErr);return false}}b.isLoaded=false;GetJPData(b.passportUrl,"verifyorgmobilesn","sn="+a,function(c){if(c.state==0){if($("#hidPageType1").val()=="1"){location.href="EmailBind.do?sn="+c.str}else{var d=$("#hidForward").val();if(d==""){location.href="MobileBind.do?sn="+c.str}else{location.href="MobileBind.do?sn="+c.str+"&forward="+d}}}else{b.FailDialog(b.codeErr.Err)}b.isLoaded=true})}};$(document).ready(function(){Base.getScript("https://skin.1yyg.net/Plugins/ygVcCode/jquery.vcCode4Mobile.js",function(){Base.getScript(Gobal.Skin+"/JS/pageDialog.js?v=160304",Wx.MobileCheck.init())})});